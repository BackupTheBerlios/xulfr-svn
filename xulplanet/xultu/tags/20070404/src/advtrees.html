
<p>Nous allons voir ici des caractéristiques supplémentaires sur les arbres.</p>

<h2>Arbres hiérarchiques</h2>

<p>L'élement <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/tree">tree</a></code> est aussi
utilisé pour créer des listes hiérarchiques, comme on en trouve dans
un gestionnaire de fichiers ou dans les listes de marque-pages d'un navigateur. La vue d'arbre
a plusieurs fonctions qui spécifient la hiérarchie des éléments dans un arbre. Chaque élément dans
l'arbre possède un niveau commençant à 0. Les éléments les plus élevés dans l'arbre auront
un niveau à 0, Les fils de ces éléments auront un niveau à 1, les fils
en dessous auront un niveau à 2, et ainsi de suite. L'arbre demandera l'affichage pour
le niveau de chaque élément afin de déterminer comment dessiner les rangées.</p>

<p>L'arbre dessinera les flèches d'ouverture et de fermeture pour ouvrir et fermer un élément parent
ainsi que les lignes reliant les fils à leurs parents. L'arbre se chargera aussi
de dessiner les rangées avec le niveau correct d'indentation. Cependant, la vue
devra s'assurer de conserver l'état des niveaux de chaque ligne si nécessaire.
Ce travail peut parfois être un peu délicat, mais heureusement, le module natif de vue d'arbre
réalise tout le travail difficile pour nous.</p>

<p>Pour créer un ensemble de rangées imbriquées, tout ce que nous devons faire est d'ajouter un second
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treechildren">treechildren</a></code>
élément à l'intérieur du parent
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treeitem">treeitem</a></code>.
Vous pouvez ensuite ajouter des éléments à l'intérieur
pour spécifier les rangées filles d'un élément. Ne mettez pas d'élément
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treechildren">treechildren</a></code>
à l'intérieur de
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treerow">treerow</a></code> car
ceci ne marchera pas.</p>

<p>Vous pouvez répéter ce processus pour créer les arbres profondément imbriqués. Essentiellement,
un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treeitem">treeitem</a></code>
peut contenir soit une simple ligne déclarée avec l'élément
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treerow">treerow</a></code>,
soit un ensemble de lignes déclarées avec l'élément 
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treechildren">treechildren</a></code>.</p>

<p>Il y a deux autres choses à faire pour vous assurer que la hiérarchie fonctionne correctement.
Premièrement, vous devez marquer l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treeitem">treeitem</a></code> 
possédant des fils comme conteneur. Il vous suffit d'ajouter l'attribut <code class="attribut">container</code> comme ceci&nbsp;:</p>

<pre><code>&lt;treeitem container="true"/&gt;</code></pre>

<p>Cet attribut permet à l'utilisateur de double-cliquer sur le 
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treeitem">treeitem</a></code> pour
déplier ou replier les lignes intérieures. Vous pouvez faire que les lignes filles soient initialement 
affichées en ajoutant l'attribut <code class="attribut">open</code>. Quand l'utilisateur
déplie ou replie le parent, la fonction <code>toggleOpenState</code> de la vue est appelée
pour basculer l'item de l'état ouvert vers l'état fermé. Pour une vue d'arbre de type contenu, il sera
ajouté un attribut <code class="attribut">open</code> pour refleter l'état courant.</p>

<p>Le second changement vous impose de mettre l'attribut <code class="attribut">primary</code>
sur la première colonne. Il fait apparaître un petit triangle ou un signe + devant les cellules
dans cette colonne pour indiquer les cellules pouvant être dépliées. De plus, les lignes
filles sont indentées. Notez aussi que l'utilisateur ne peut pas cacher cette colonne
via le petit menu déroulant à droite des colonnes.</p>

<h3>Exemple d'arbre hiérarchique</h3>

<p>Voici un exemple simple&nbsp;:</p>

<p>Exemple 8.2.1&nbsp;: 
<a href="exemples/ex_advtrees_1.xul.txt">Source</a>
<a href="exemples/ex_advtrees_1.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">Voir</a></p>

<pre><code>&lt;tree rows="6"&gt;
  &lt;treecols&gt;
      &lt;treecol id="firstname" label="Prénoms" primary="true" flex="3"/&gt;
      &lt;treecol id="lastname" label="Noms" flex="7"/&gt;
  &lt;/treecols&gt;

  &lt;treechildren&gt;
    &lt;treeitem container="true" open="true"&gt;
      &lt;treerow&gt;
        &lt;treecell label="Personnes"/&gt;
      &lt;/treerow&gt;

      &lt;treechildren&gt;
        &lt;treeitem&gt;
          &lt;treerow&gt;
            &lt;treecell label="Bob"/&gt;
            &lt;treecell label="Carpenter"/&gt;
          &lt;/treerow&gt;
        &lt;/treeitem&gt;
        &lt;treeitem&gt;
          &lt;treerow&gt;
            &lt;treecell label="Jerry"/&gt;
            &lt;treecell label="Hodge"/&gt;
          &lt;/treerow&gt;
        &lt;/treeitem&gt;
      &lt;/treechildren&gt;
    &lt;/treeitem&gt;
  &lt;/treechildren&gt;
&lt;/tree&gt;</code></pre>

<p><img src="images/advtrees1.png" class="screenshot-right" alt="" />
Cet exemple crée un arbre hiérarchique. Comme on peut le voir sur l'image, un petit signe plus 
ou moins (souvent appelé «&nbsp;twisty&nbsp;») est
apparu sur la première ligne, indiquant qu'elle contient des lignes filles. En double-cliquant
sur la ligne, l'utilisateur ouvre ou ferme la liste. Les lignes filles sont indentées.
Notez comment la ligne «&nbsp;Personnes&nbsp;» n'a besoin que d'une colonne.</p>

<p>L'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treeitem">treeitem</a></code> 
externe contient un seul élément
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treerow">treerow</a></code> 
et un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treechlidren">treechildren</a></code>.
Le premier crée la donnée pour la ligne parente et le deuxième contient les items fils.</p>

<p>Vous pouvez imbriquer autant de lignes que vous le désirez. Souvenez-vous que vous devez
utiliser l'attribut <code class="attribut">container</code> sur les lignes qui ont
des lignes filles. La simple présence de lignes filles n'est pas suffisante pour
l'indiquer, car vous pourriez avoir un conteneur sans enfants mais
qui devrait quand même être traité comme un conteneur. Par exemple, un répertoire sans fichier devrait
être traité comme un conteneur alors qu'un fichier ne le devrait pas.</p>

<h2>Plus sur les colonnes d'arbres</h2>

<p><code class="attribut">enableColumnDrag</code> est un attribut supplémentaire que 
vous pouvez ajouter à l'arbre. S'il est mis à <var>true</var>, l'utilisateur peut
alors déplacer les en-têtes de colonne afin de réarranger l'ordre des colonnes.</p>

<p>Un utilisateur peut également vouloir modifier la largeur des colonnes. Il vous suffit de placer
un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/splitter">splitter</a></code>
entre chaque élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/treecol">treecol</a></code>. 
Une petite encoche apparaissant entre chaque en-tête de colonne pourra être déplacée par
l'utilisateur pour changer la largeur d'une colonne.
Vous pouvez utiliser la classe de style <var>tree-splitter</var> pour masquer l'encoche bien que la colonne
puisse encore être retaillée.</p>

<p>Vous pouvez affecter une largeur minimale ou maximale à une colonne, en utilisant les attributs
<code class="attribut">minwidth</code> et <code class="attribut">maxwidth</code> sur les en-têtes de colonnes.</p>

<p>Vous pouvez mettre l'attribut <code class="attribut">hidden</code> à <var>true</var> pour cacher par défaut une colonne. L'utilisateur pourra afficher la colonne en la sélectionnant dans la liste
déroulante au bout de la ligne des en-têtes de colonne.</p>

<h3>mémorisation de l'état des colonnes</h3>

<p><img src="images/advtrees2.png" class="screenshot-right" alt="" />
Comme avec tous les éléments XUL, l'attribut <code class="attribut">persist</code> peut être utilisé pour sauvegarder
l'état des colonnes entre chaque session. Ainsi, la façon dont l'utilisateur aura choisi l'affichage des colonnes 
sera automatiquement sauvegardé pour sa prochaine session. Vous pouvez sauvegarder plusieurs attributs, comme
indiqué dans l'exemple ci-dessous&nbsp;:</p>

<p>Exemple 8.2.2&nbsp;: 
<a href="exemples/ex_advtrees_2.xul.txt">Source</a>
<a href="exemples/ex_advtrees_2.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">Voir</a></p>

<pre><code>&lt;tree enableColumnDrag="true" flex="1"&gt;

  &lt;treecols&gt;
    &lt;treecol id="runner" label="Coureur" flex="2" persist="width ordinal hidden"/&gt;
    &lt;splitter class="tree-splitter"/&gt;
    &lt;treecol id="city" label="Ville" flex="2" persist="width ordinal hidden"/&gt;
    &lt;splitter class="tree-splitter"/&gt;
    &lt;treecol id="starttime" label="Heure de départ" flex="1" persist="width ordinal hidden"/&gt;
    &lt;splitter class="tree-splitter"/&gt;
    &lt;treecol id="endtime" label="Heure d'arrivée" flex="1" persist="width ordinal hidden"/&gt;
  &lt;/treecols&gt;

  &lt;treechildren&gt;
    &lt;treeitem&gt;
      &lt;treerow&gt;
        &lt;treecell label="Joshua Granville"/&gt;
        &lt;treecell label="Vancouver"/&gt;
        &lt;treecell label="7:06:00"/&gt;
        &lt;treecell label="9:10:26"/&gt;
      &lt;/treerow&gt;
    &lt;/treeitem&gt;
    &lt;treeitem&gt;
      &lt;treerow&gt;
        &lt;treecell label="Robert Valhalla"/&gt;
        &lt;treecell label="Seattle"/&gt;
        &lt;treecell label="7:08:00"/&gt;
        &lt;treecell label="9:15:51"/&gt;
      &lt;/treerow&gt;
    &lt;/treeitem&gt;
  &lt;/treechildren&gt;
&lt;/tree&gt;</code></pre>

<p>Trois attributs des colonnes doivent être persistants,</p>

<ul>
  <li>l'attribut <code class="attribut">width</code> pour sauver les largeurs de colonnes,</li>
  <li>l'attribut <code class="attribut">ordinal</code> contenant la position de la colonne,</li>
  <li>et l'attribut <code class="attribut">hidden</code> indiquant si la colonne est visible ou invisible.</li>
</ul>

<hr />

<p>Dans la prochaine section, nous allons voir comment récupérer ou spécifier une sélection sur un arbre.</p>
