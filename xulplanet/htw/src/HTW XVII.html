
<p>Les gabarits peuvent être utilisés pour générer n'importe quel type de contenu. Habituellement, un gabarit est utilisé pour générer les items d'un menu, d'une liste de choix ou d'un arbre. La syntaxe est la même quelque soit le type de contenu devant être créé. Dans le précédent exemple, nous avions codé "en dur" un menu déroulant avec la liste des pays, mais nous aurions pu générer cette liste à partir de la source de données. La même source de données peut être utilisée à la fois pour la liste des photos et le menu déroulant. Même si la même source de données est utilisée, elle ne sera chargée qu'une seule fois et les deux gabarits seront informés lorsque les données sont chargées.</p>

<p>Nous devrons ajouter quelques informations à la source de données afin de spécifier la liste des pays disponibles. Il y a deux possibilités. Premièrement, un Seq séparé peut être ajouté pour lister les pays. Deuxièmement, nous pouvons utiliser un type RDF pour spécifier les pays. Ensuite, il nous suffit de rechercher toutes les ressources ayant le type <var>Country</var>. Nous utiliserons cette méthode ici puisque nous avons déjà vu des exemples la génération de contenu depuis un conteneur.</p>

<p>Un type RDF peut être assigné à un noeud par l'emploi du prédicat <var>http://www.w3.org/1999/02/22-rdf-syntax-ns#type</var> défini vers une ressource de ce type. En RDF/XML, une syntaxe raccourcie permet de remplacer la balise Description avec le type. Nous allons ajouter les deux pays dans le source de données, après s'être assuré que l'espace de nommage a été déclaré dans la balise RDF racine&nbsp;:</p>

<pre><code>&lt;nso:Country about="http://www.daml.org/2001/09/countries/iso#IT"
             dc:title="Italy"/&gt;
&lt;nso:Country about="http://www.daml.org/2001/09/countries/iso#NL"
             dc:title="Netherlands"/&gt;</code></pre>

<p>Le type des ces deux ressources, après complétion de l'espace de nommage (non montré ici), sera <var>http://www.daml.org/2001/09/countries/country-ont#Country</var>. Les triplets RDF résultants pour le premier pays seront&nbsp;:</p>

<pre><code>http://www.daml.org/2001/09/countries/iso#IT
  -> http://www.w3.org/1999/02/22-rdf-syntax-ns#type
  -> http://www.daml.org/2001/09/countries/country-ont#Country
http://www.daml.org/2001/09/countries/iso#IT
  -> http://purl.org/dc/elements/1.1/title
  -> Italie</code></pre>

<p>Le type ressemble à tous ceux des autres triplets dans <a href="exemples/template-guide-photos4.rdf">la source de données</a>, donc aucune syntaxe spéciale n'est requise pour naviguer dans celle-ci. Il suffit simplement d'utiliser le prédicat adéquat pour rechercher tous les pays. On peut se demander comment doit être défini l'attribut <code class="attribut">ref</code> ou le point de départ puisque les pays n'ont pas de conteneur. En fait, le type servira de point de départ.</p>

<pre><code>&lt;menulist datasources="template-guide-photos4.rdf"
          ref="http://www.daml.org/2001/09/countries/country-ont#Country"&gt;</code></pre>

<p>Souvenez vous que la seule nécessité est d'avoir une ressource comme point de départ, quelque soit cette ressource. Les conditions auront besoin de parcourir les arcs pointant vers les ressources de type. Puisque les arcs pointent vers le type, nous devons déterminer la source ou le sujet du triplet. Regardez une nouvelle fois les triplets RDF obtenus ci-avant si ce n'est pas clair. Le noeud de départ est <var>http://www.daml.org/2001/09/countries/country-ont#Country</var>. Nous devons parcourir les données selon le prédicat 'type' pour trouver les pays individuellement. Un second triplet est utilisé pour obtenir le titre du pays.</p>

<pre><code>&lt;conditions&gt;
  &lt;content uri="?start"/&gt;
  &lt;triple subject="?country"
          predicate="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
          object="?start"/&gt;

  &lt;triple subject="?country"
          predicate="http://purl.org/dc/elements/1.1/title"
          object="?countrytitle"/&gt;
&lt;/conditions&gt;</code></pre>

<p>Le corps d'action devra ensuite générer un <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menuitem">menuitem</a></code> pour chaque résultat. Il devra également inclure un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menupopup">menupopup</a></code> autour de ces items. Comme un seul <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menupopup">menupopup</a></code> devra être généré, il devra être placé en dehors de l'élément ayant l'attribut <code class="attribut">uri</code>. Seul le contenu à partir de l'élément ayant l'attribut <code class="attribut">uri</code> et ceux qu'il contient seront dupliqués pour chaque résultat. Les éléments en dehors ne le seront pas.</p>

<pre><code>&lt;action&gt;

  &lt;menupopup&gt;
    &lt;menuitem uri="?country" label="?countrytitle" value="?country"/&gt;
  &lt;/menupopup&gt;
&lt;/action&gt;</code></pre>

<p>Le résultat sera deux <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menuitem">menuitem</a></code> générés, un pour chaque pays, à l'intérieur d'un <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menupopup">menupopup</a></code>. L'attribut <code class="attribut">value</code> reçoit la variable ?country afin que la fonction <code>applyFilter</code> puisse facilement se servir de cette valeur lors du filtrage. <a href="exemples/template-guide-ex17.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">L'exemple complet</a> en montre le fonctionnement.</p>

<p class="note">Notez qu'à cause d'un bogue avec la génération des listes de menu dans les gabarits alors que la source de données n'est pas encore chargée, vous devez charger l'exemple une deuxième fois pour qu'il fonctionne. Le problème affecte seulement l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menulist">menulist</a></code>. Plusieurs solutions peuvent être utilisées dans ce simple exemple. Tout d'abord, vous pouvez déplacer l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menupopup">menupopup</a></code> en dehors du gabarit et de lui affecter l'attribut <code class="attribut">datasources</code> à la place de l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menulist">menulist</a></code>. Cela fonctionnera dans cet exemple simple, mais aura l'inconvénient que le constructeur ne générera paresseusement le contenu que lorsque le menu déroulant sera ouvert. Une autre méthode consisterait à reconstruire le gabarit dès que les données ont été chargées.</p>

<p>Ensuite, nous verrons comment ajouter le choix de tous les pays au menu, cette indication ne figurant pas dans la source de données.</p> 
