
<p>Le contenu devant être généré dans le gabarit est défini en utilisant l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> qui doit être un fils direct d'un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/rule">rule</a></code>. Le contenu est placé directement à l'intérieur de l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code>. Ce contenu sera dupliqué pour chaque résultat correspondant et inséré dans le document. Voici un premier exemple simple.</p>

<pre><code>&lt;vbox datasources="http://www.xulplanet.com/ds/sample.rdf"
         ref="http://www.xulplanet.com/rdf/A"&gt;
  &lt;template&gt;
    &lt;rule&gt;
      &lt;conditions&gt;
        &lt;content uri="?start"/&gt;
        &lt;triple subject="?start"
                predicate="http://www.xulplanet.com/rdf/relatedItem"
                object="?relateditem"/&gt;
      &lt;/conditions&gt;
      &lt;action&gt;
        &lt;button uri="?relateditem" label="?relateditem"/&gt;
      &lt;/action&gt;
    &lt;/rule&gt;
  &lt;/template&gt;
&lt;/vbox&gt;</code></pre>

<p>Cet élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> contient ici un seul élément, mais vous pouvez en mettre autant que vous le voulez. Dans le cas présent, un bouton sera créé pour chaque résultat. Il y a trois résultats, donc trois boutons seront créés. Voici l'<a href="exemples/template-guide-ex1.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">exemple</a> et l'image résultante&nbsp;:</p>

<p><img src="images/template-guide-p8.png" alt="Exemple simple RDF avec trois boutons" class="screenshot" /></p>

<p>Le constructeur de gabarits parcourt les trois résultats, et déroule le corps de l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> pour chacun d'eux. L'attribut <code class="attribut">uri</code> sur le bouton spécifie la variable cible ou membre. Dans cet exemple, la variable ?relatedItem est la seule à servir puisque ?start est le point de départ, et que les points de départ et d'arrivée ne peuvent pas être les mêmes. Plusieurs choses vont se produire pour chaque résultat. Regardons de nouveau les résultats&nbsp;:</p>

<pre><code>(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/B)
(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/C)
(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/D)</code></pre>

<p>Le constructeur démarrera avec le premier résultat. L'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/button">button</a></code> sera dupliqué et inséré dans le document après le gabarit. L'attribut <code class="attribut">id</code> du nouvel élément sera défini comme étant la valeur de la variable membre, ?relatedItem. Vous n'avez qu'à imaginer que l'attribut <code class="attribut">uri</code> devienne l'attribut <code class="attribut">id</code> affecté de la valeur de la variable. Comme le premier résultat a la valeur <var>http://www.xulplanet.com/rdf/B</var> affectée à la variable ?relatedItem, l'<code class="attribut">id</code> se verra affecté de la même valeur.</p>

<p>Ensuite, les attributs restants sur l'élément sont examinés et toutes les variables présentes sont remplacées. De ce fait, le texte <var>?relatedItem</var> situé dans l'attribut <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/label">label</a></code> sera remplacé par la chaîne de caractères <var>http://www.xulplanet.com/rdf/B</var> pour le premier résultat. Dans l'image ci-dessus, vous pouvez constater que le premier bouton contient effectivement cette valeur. Le processus étant maintenant complet pour le premier résultat, le constructeur peut s'attaquer au prochain résultat. Pour le résultat B, le constructeur aura généré le contenu suivant&nbsp;:</p>

<pre><code>&lt;button id="http://www.xulplanet.com/rdf/B" label="http://www.xulplanet.com/rdf/B"/&gt;</code></pre>

<p>Naturellement, vous ne devez pas utiliser d'attribut <code class="attribut">id</code> à l'intérieur de l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> du gabarit puisque cet identifiant sera de toutes façons remplacé. En fait, tous les identifiants <code class="attribut">id</code> placés dans un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> d'un gabarit sera ignoré. Toutefois, vous pouvez utiliser des identifiants sur d'autres parties du gabarit, telles qu'à l'intérieur de <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/conditions">conditions</a></code>, si vous désirez modifier les conditions et reconstruire le gabarit. Vous pouvez utiliser la fonction <code>getElementById</code> pour obtenir un résultat particulier, par exemple <code>document.getElementById("http://www.xulplanet.com/rdf/C")</code> retournera le second bouton généré.</p>

<p>Une fois que tous les résultats ont été examinés, l'arbre du DOM ressemblera à ceci&nbsp;:</p>

<pre><code>&lt;vbox datasources="http://www.xulplanet.com/ds/sample.rdf"
         ref="http://www.xulplanet.com/rdf/A"&gt;
  &lt;template&gt;
    &lt;rule&gt;
      &lt;conditions&gt;
        &lt;content uri="?start"/&gt;
        &lt;triple subject="?start"
                predicate="http://www.xulplanet.com/rdf/relatedItem"
                object="?relateditem"/&gt;
      &lt;/conditions&gt;
      &lt;action&gt;
        &lt;button uri="?relateditem" label="?relateditem"/&gt;
      &lt;/action&gt;
    &lt;/rule&gt;
  &lt;/template&gt;
  &lt;button id="http://www.xulplanet.com/rdf/B" label="http://www.xulplanet.com/rdf/B"/&gt;
  &lt;button id="http://www.xulplanet.com/rdf/C" label="http://www.xulplanet.com/rdf/C"/&gt;
  &lt;button id="http://www.xulplanet.com/rdf/D" label="http://www.xulplanet.com/rdf/D"/&gt;
&lt;/vbox&gt;</code></pre>

<p>Comme la balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/template">template</a></code> est invisible, l'effet sera similaire à l'image, soit trois boutons avec en libellés les données de la source de données.</p>

<h3>Contenu supplémentaire</h3>

<p>L'exemple précédent ne générait qu'un ensemble de boutons, mais le corps d'<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> peut contenir d'autres contenus. Par exemple, vous pourriez ajouter un libellé à chaque item.</p>

<pre><code>&lt;action&gt;
  &lt;hbox uri="?relateditem"&gt;
    &lt;label value="Items liés :"/&gt;
    &lt;button label="?relateditem"/&gt;
  &lt;/hbox&gt;
&lt;/action&gt;</code></pre>

<p>Dans cet exemple, l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/hbox">hbox</a></code> sera généré pour chaque résultat en ayant un <code class="attribut">id</code> égal à la valeur de ?relatedItem, et il contiendra un libellé et un bouton. Le libellé du bouton sera la valeur de la variable ?relatedItem. Vous ne pouvez utiliser l'attribut <code class="attribut">uri</code> que sur un seul élément puisqu'un seul des éléments générés ne peut obtenir un identifiant <code class="attribut">id</code> donné.</p>

<p>Bien que l'attribut <code class="attribut">uri</code> ne doit être placé que sur un seul élément, d'autres éléments peuvent être inclus dans le corps d'<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code>. Vous pouvez mettre d'autres éléments autour de celui avec l'attribut <code class="attribut">uri</code> pour servir de conteneur à tous les résultats. La seule différence est que ce contenu supplémentaire n'est généré qu'une seule fois, et non pour chaque résultat. Seul le contenu de l'élément avec l'attribut <code class="attribut">uri</code> et ses enfants est dupliqué pour chaque résultat. Par exemple, si l'exemple était modifié comme ceci&nbsp;:</p>

<pre><code>&lt;action&gt;
  &lt;toolbar&gt;
    &lt;button uri="?relateditem" label="?relateditem"/&gt;
  &lt;/toolbar&gt;
&lt;/action&gt;</code></pre>

<p>Ici, seul le bouton sera répété pour chaque résultat&nbsp;; l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/toolbar">toolbar</a></code> ne sera répété qu'une seule fois. La barre d'outils <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/toolbar">toolbar</a></code> est créée juste avant que le contenu pour le premier résultat ne soit généré. Le résultat final sera une barre d'outils avec à l'intérieur une série de trois boutons. Bien sûr, dans cet exemple simple, vous devriez placer le <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/toolbar">toolbar</a></code> comme l'élément externe avec l'attribut <code class="attribut">datasources</code> plutôt que de le placer à l'intérieur d'<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code>.</p>

<p>Jusque là, nous avons simplement utilisé la variable ?relatedItem puisqu'elle était la seule variable disponible. Nous pourrions également utiliser la variable ?start. Souvenez vous des résultats&nbsp;:</p>

<pre><code>(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/B)
(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/C)
(?start = http://www.xulplanet.com/rdf/A, ?relateditem = http://www.xulplanet.com/rdf/D)</code></pre>

<p>Nous pourrions afficher la valeur de la variable ?start disponible dans les résultats&nbsp;:</p>

<pre><code>&lt;action&gt;
  &lt;hbox uri="?relateditem"&gt;
    &lt;button label="?start"/&gt;
    &lt;button label="?relateditem"/&gt;
  &lt;/hbox&gt;
&lt;/action&gt;</code></pre>

<p>Pour le premier bouton, la valeur de la variable ?start montrera les résultats des données tandis que le second bouton utilisera la variable ?relatedItem. Puisque les trois résultats ont la même valeur pour la variable ?start, les trois premiers boutons de chaque ligne auront le même libellé. Voici une image de <a href="exemples/template-guide-ex2.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">cet exemple</a>&nbsp;:</p>

<img src="images/template-guide-p9.png" alt="Capture d'écran" class="screenshot" />

<p>Vous noterez que la seconde ligne contient deux boutons surnuméraires. Nous verrons la raison par la suite.</p>
