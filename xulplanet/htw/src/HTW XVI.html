
<p>L'exemple précédent vous a montré comment naviguer 'vers le haut' dans le graphe RDF. En décrivant prudemment le graphe RDF et en utilisant les triplets adéquats, vous pouvez naviguer vers n'importe quelle partie du graphe RDF nécessaire à l'obtention de vos résultats. Toutefois, il vous est plus courant de parcourir seulement les fils d'un noeud en utilisant une balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/member">member</a></code> et, puis d'utiliser un <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code> ou <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/binding">binding</a></code> pour chacun des prédicats de chaque fils à afficher. C'est dans ce but que le système de gabarits fût conçu à l'origine et de nombreuses sources de données utilisées par Firefox ou par d'autres produits Mozilla fonctionnent ainsi.</p>

<p>Une forme non courante de navigation que vous pouvez employer est de naviguer vers le haut en utilisant une balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/member">member</a></code> qui se chargera de récupérer tous les parents d'un noeud, comme dans cet exemple&nbsp;:</p>

<pre><code>&lt;conditions&gt;
  &lt;content uri="?start"/&gt;
  &lt;member container="?parent" child="?start"/&gt;
&lt;/conditions&gt;</code></pre>

<p>Cette forme pourra être utilisée, par exemple, pour commencer sur une photo particulière et pour trouver tous les conteneurs dans lesquels elle se trouve.</p>

<p>Parfois, vous pouvez vouloir modifier les conditions ultérieurement. Par exemple, l'utilisateur peut choisir une valeur dans une liste, et les résultats du gabarit devront être filtrés à partir de cette valeur. Il suffit de modifier les noeuds DOM à l'intérieur des conditions et de reconstruire le gabarit. Par exemple, pour appliquer un filtre, vous pouvez ajouter un nouvel élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code>. Pour enlever le filtre, ce <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code> devra être supprimé. Supposons que nous ayons attribué un id <code class="attribut">cond</code> sur la balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/conditions">conditions</a></code>.</p>

<pre><code>function applyFilter(country)
{
  var cond = document.getElementById("cond");
  var triple = document.getElementById("filterTriple");
  if (country) {
    if (!triple) {
      triple = document.createElement("triple");
      triple.id = "filterTriple";
      triple.setAttribute("subject", "?photo");
      triple.setAttribute("predicate", "http://www.daml.org/2001/09/countries/iso-3166-ont#Country");
    }
    triple.setAttribute("object", country);
    cond.appendChild(triple);
  }
  else if (triple) {
    cond.removeChild(triple);
  }
  document.getElementById("photosList").builder.rebuild();
}</code></pre>

<p>L'argument 'country' de la fonction <code>applyFilter</code> contient la valeur du filtre. Si cette valeur est définie, nous ajoutons un filtre, autrement il est supprimé. Le code est particulièrement direct. Un nouvel élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code> est créé et l'attribut <code class="attribut">object</code> est défini avec la valeur servant de filtre. Par exemple, le triplet résultant d'un filtre sur les Pays bas serait&nbsp;:</p>

<pre><code>&lt;triple subject="?photo"
        predicate="http://www.daml.org/2001/09/countries/iso-3166-ont#Country"
        object="http://www.daml.org/2001/09/countries/iso#NL"/&gt;</code></pre>

<p>Ce triplet est ajouté aux conditions. Un identifiant id est attribué au triplet afin de pouvoir le retrouver si un filtre différent est appliqué. Naturellement, un seul filtre est appliqué à la fois, donc nous pouvons réutiliser le même triplet pour chaque filtre. Pour supprimer le filtre, nous devons simplement ôter le triplet des conditions. Cet exemple n'ajoute qu'un seul triplet, mais vous pouvez en ajouter d'autres, ou bien même des éléments <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/member">member</a></code>. Dès lors qu'un triplet ou un membre est ajouté ou supprimé, le gabarit doit être reconstruit en appelant la méthode <code>rebuild</code>. Cette méthode supprimera tout le contenu généré existant, effacera toutes les informations internes appartenant aux résultats, et redémarrera comme si le gabarit venait tout juste d'être examiné pour la première fois. Le gabarit sera analysé de nouveau et les données seront examinées pour de nouveaux résultats.</p>

<p>Vous pouvez <a href="exemples/template-guide-ex16.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">voir l'exemple complet</a> de cette action. Un menu déroulant permet à l'utilisateur de sélectionner soit un pays spécifique, ou soit l'affichage de toutes les photos. Lorsque le choix est effectué, la fonction <code>applyFilter</code> telle que montrée ci-dessus, est appelée et le contenu du gabarit est reconstruit selon le filtre désiré qui a été appliqué.</p>

<p>Dans cet exemple, le menu déroulant est écrit "en dur" pour contenir les items que nous savons être dans la source de données. Par la suite, nous verrons comment générer également cette liste en utilisant un gabarit.</p>
