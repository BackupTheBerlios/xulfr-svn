
<p>Lorsqu'il est nécessaire de parcourir les fils d'un conteneur RDF, une syntaxe de règle simplifiée peut être utilisée. Elle peut également être utilisée pour parcourir un seul prédicat. Naviguer dans de tel graphe RDF est courant, donc la syntaxe simplifiée est justifiée dans cette situation puisqu'elle limite le nombre de balises. Bien qu'il s'agisse d'une syntaxe simple, elle n'en est pas moins efficace, au moins lorsqu'une règle est invoquée. Une règle simple est équivalente à une règle ayant seulement une balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/content">content</a></code> et une balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/tag">tag</a></code>, de même qu'une série optionnelle de triplets à partir du noeud enfant. Dans sa forme la plus simple, la syntaxe de la règle simplifiée est équivalente aux conditions suivantes&nbsp;:</p>

<pre><code>&lt;conditions&gt;
  &lt;content uri="?start"/&gt;
  &lt;member container="?start" child="?photo"/&gt;
&lt;/conditions&gt;</code></pre>

<p>Le constructeur de gabarits utilise la syntaxe de règle simplifiée à chaque fois la règle du gabarit ne contient pas d'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/conditions">conditions</a></code>. Si un élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/conditions">conditions</a></code> est présent, la syntaxe complète est utilisée à la place. Dans la syntaxe simplifiée, le constructeur utilisera les conditions par défaut indiquées ci-avant, bien que les noms de variables soient générées aléatoirement.</p>

<p>Puisque la liste des photos parcourt les fils d'un conteneur, nous pouvons utiliser la syntaxe simplifiée. Voici à quoi elle devra ressembler&nbsp;:</p>

<pre><code>&lt;rule&gt;
  &lt;vbox class="box-padded" uri="rdf:*"&gt;
    &lt;image src="rdf:*"/&gt;
    &lt;label value="rdf:http://purl.org/dc/elements/1.1/title"/&gt;
  &lt;/vbox&gt;
&lt;/rule&gt;</code></pre>

<p>Aucun élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/conditions">conditions</a></code> ou <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/action">action</a></code> n'est utilisé. À la place, le constructeur utilise une série de conditions par défaut, et l'action est placée directement à l'intérieur de l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/rule">rule</a></code>. Vous pouvez constater que ce code est bien plus simple que la syntaxe complète. Pour comprendre comment il fonctionne, examinons comment le constructeur traite une règle simplifiée. Tout d'abord, il évalue les conditions par défaut comme ci-dessus, excepté qu'aucune variable n'est utilisée, ou tout au moins aucune utilisée en externe. En réalité, il faut considérer que le constructeur convertit une règle simplifiée en une règle étendue, et ainsi il procède de la même manière. Après que les conditions par défaut aient été évaluées, le réseau d'information ressemble à quelque chose comme ceci&nbsp;:</p>

<pre><code>(?1 = http://www.xulplanet.com/rdf/myphotos,
 ?2 = http://www.xulplanet.com/ndeakin/images/t/palace.jpg)
(?1 = http://www.xulplanet.com/rdf/myphotos,
 ?2 = http://www.xulplanet.com/ndeakin/images/t/canal.jpg)
(?1 = http://www.xulplanet.com/rdf/myphotos,
 ?2 = http://www.xulplanet.com/ndeakin/images/t/obselisk.jpg)</code></pre>

<p>Les nombres sont utilisés ici comme noms de variables, mais en réalité, ils sont générés aléatoirement et vous ne pouvez pas y faire référence en aucune manière. Les données membres, ou les résultats sont contenus dans la variable représentée par <var>?2</var>. Trois correspondances ont été trouvées donc le contenu sera dupliqué trois fois.</p>

<p>Il existe différents attributs dans le contenu ayant un préfixe <var>rdf:</var> sur leur valeurs. Comme vous ne pouvez pas déclarer de variables avec la syntaxe simplifiée, une autre manière est employée pour obtenir les données RDF. Le préfixe <var>rdf:</var> signifie de rechercher un prédicat pointant en dehors d'un noeud vers ce résultat (le fils ou le membre d'un noeud). Par exemple, l'attribut <code class="attribut">value</code> du libellé a une valeur de <var>rdf:http://purl.org/dc/elements/1.1/title</var>. Il signifie de rechercher la valeur du prédicat "http://purl.org/dc/elements/1.1/title" pointant en dehors du résultat courant. Bien sûr, il devient évident que cet attribut définira le titre de la photo.</p>

<p>Vous pouvez obtenir d'autres prédicats de la même manière, simplement en utilisant le prédicat uri et en lui ajoutant le préfixe <var>rdf:</var>. Vous pouvez également combiner deux résultats dans un seul attribut en les séparant par un espace ou un signe ^ comme vous le feriez avec la syntaxe complète. Par exemple&nbsp;:</p>

<pre><code>&lt;label value="rdf:http://purl.org/dc/elements/1.1/title http://www.xulplanet.com/rdf/country"/&gt;</code></pre>

<p>La forme <var>rdf:</var> est réellement équivalente à la balise <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/binding">binding</a></code> de la syntaxe complète. Le sujet de la liaison est la ressource membre résultante, le prédicat est la chaîne de caractères venant juste après <var>rdf:</var> et l'objet n'est pas nécessaire car la valeur est remplacée directement dans l'attribut. Comme avec les liaisons, la valeur n'est pas nécessaire pour assurer la correspondance, donc les données n'ont pas à être présentes dans le graphe RDF. Si une photo n'a pas de titre, celui-ci sera remplacé par une chaîne de caractères vide.</p>

<p>La valeur spéciale <var>rdf:*</var> signifie l'uri de la ressource résultat, plutôt que la référence à un prédicat. Elle est équivalente à la variable ?photo dans cet exemple si la syntaxe complète était utilisée. Vous pouvez voir dans l'exemple que la valeur <var>rdf:*</var> est utilisée à deux endroits, au niveau de l'attribut <code class="attribut">uri</code> sur le <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/hbox">hbox</a></code> et de l'attribut <code class="attribut">src</code> pour l'image.</p>

<p>Voici <a href="exemples/template-guide-ex19.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">l'exemple des photos</a> utilisant la syntaxe simplifiée. Le filtrage n'est pas présent dans cet exemple. Il est toutefois possible de faire le filtrage en utilisant des règles simplifiées, c'est ce que nous verrons par la suite.</p>

<h3>Conditions de règle simplifiée</h3>

<p>Les règles simplifiées utilisent également une méthode plus simple pour le traitement des conditions de filtre des résultats indésirables. Cette méthode vous permet de filtrer les résultats qui ont certains prédicats avec des valeurs spécifiques. Par exemple, vous pouvez filtrer les résultats d'une certaine catégorie ou pays. Vous ne pouvez filtrer que sur des prédicats pointant en dehors de la ressource membre. Ceci dit, vous ne pouvez pas filtrer sur des prédicats pointant vers une ressource membre, ou sur des prédicats pointant vers d'autres ressources.</p>

<p>Les conditions sont définies en utilisant des attributs sur l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/rule">rule</a></code>. L'espace de nommage de l'attribut et le nom de l'attribut sont combinés pour former le prédicat servant de filtre et la valeur de l'attribut sera la valeur du filtre à appliquer. Tous les résultats correspondant au critère sont acceptés et tous ceux qui n'y correspondent pas sont rejetés. Vous pouvez utiliser de multiples attributs pour filtrer sur plusieurs critères. Dans ce cas, les résultats seront acceptés s'ils correspondent à tous les critères.</p>

<p>Par exemple, pour filtrer les photos d'un pays spécifique&nbsp;:</p>

<pre><code>&lt;hbox id="photosList" datasources="template-guide-photos4.rdf"
      ref="http://www.xulplanet.com/rdf/myphotos"
      xmlns:r="http://www.xulplanet.com/rdf/"&gt;
  &lt;template&gt;
    &lt;rule r:country="http://www.daml.org/2001/09/countries/iso#IT"&gt;
      &lt;vbox class="box-padded" uri="rdf:*"&gt;
        &lt;image src="rdf:*"/&gt;
        &lt;label value="rdf:http://purl.org/dc/elements/1.1/title"/&gt;
      &lt;/vbox&gt;
    &lt;/rule&gt;
  &lt;/template&gt;
&lt;/hbox&gt;</code></pre>

<p>Cet <a href="exemples/template-guide-ex20.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">exemple</a> montre comment un unique attribut peut servir à filtrer seulement les résultats dont le pays 'country' est défini à <var>http://www.daml.org/2001/09/countries/iso#IT</var>. Le contenu des photos n'étant pas de ce pays ne sera pas généré. L'attribut a un espace de nommage qui, une fois substitué, devient <var>http://www.xulplanet.com/rdf/country</var>. Cette syntaxe n'est pas très différente de la façon dont les prédicats sont définis dans <a href="exemples/template-guide-photos4.rdf">le RDF/XML</a>.</p>

<p>L'emploi de cette forme de syntaxe d'attribut sur une règle est équivalente à un <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code> dans la syntaxe étendue. En fait, le constructeur va convertir en interne l'attribut dans la même forme compilée qui serait utilisée par un <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/triple">triple</a></code>. Le triplet équivalent à l'exemple ci-dessus serait&nbsp;:</p>

<pre><code>&lt;triple subject="?photo"
        predicate="http://www.xulplanet.com/rdf/country"
        object="http://www.daml.org/2001/09/countries/iso#IT"/&gt;</code></pre>

<h3>Ajustement des conditions de la règle simplifiée</h3>

<p>La syntaxe simplifiée de règles est limitée dans les possibilités de filtrage, toutefois elle est suffisante dans de nombreuses cas. Naturellement, si vous souhaitez réaliser un filtre dynamique, comme le réalise l'exemple des photos avec la liste déroulante, vous devrez modifier l'attribut sur l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/rule">rule</a></code> et reconstruire le gabarit.</p>

<pre><code>function applyFilter(country)
{
  var rule = document.getElementById("filterRule");
  if (country){
    rule.setAttributeNS("http://www.xulplanet.com/rdf/", "country", country);
  }
  else {
    rule.removeAttributeNS("http://www.xulplanet.com/rdf/", "country");
  }
  document.getElementById("photosList").builder.rebuild();
}</code></pre>

<p>Cette version de la fonction <code>applyFilter</code> ne fait que définir ou enlever l'attribut sur la règle selon les besoins. Notez l'emploi des fonctions dédiées aux espaces de nommage (avec le suffixe NS) pour définir ou enlever les attributs avec espaces de nommage. <a href="exemples/template-guide-ex20b.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">Cet exemple</a> suppose que l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/rule">rule</a></code> contient un identifiant <code class="attribut">id</code> <var>filterRule</var>. Notez que la liste déroulante elle même doit utiliser la syntaxe étendue puisqu'elle ne parcourt pas les fils d'une ressource.</p>

<h3>Filtrage utilisant plusieurs tests</h3>

<p>Comme il a été mentionné plus tôt, vous pouvez filtrer selon plusieurs critères en utilisant de multiples attributs. Par exemple&nbsp;:</p>

<pre><code>&lt;rule id="filterRule"
      dc:title="Obelisk"
      r:country="http://www.daml.org/2001/09/countries/iso#IT"&gt;</code></pre>

<p>Les deux critères de filtre sur cette règle doivent être respectés. Les règles traitent tous les attributs comme des conditions à l'exception de l'attribut <code class="attribut">id</code> ainsi que d'autres attributs spéciaux qui sont ignorés. Ces attributs spéciaux sont utiles lors du traitement de règles multiples, ce qui sera le sujet d'une prochaine section.</p>
