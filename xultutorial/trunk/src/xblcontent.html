


<p>
Dans cette section, nous allons voir comment créer un contenu avec <acronym title="eXtended Binding Language">XBL</acronym>.
</p>

<h2>Le contenu XBL</h2>

<p>
XBL peut être utilisé pour ajouter automatiquement un ensemble d'éléments à l'intérieur d'un autre
élément. Le fichier XUL a uniquement besoin de spécifier l'élément externe tandis que l'élément
interne est décrit dans un fichier XBL. C'est utile pour créer un élément graphique simple qui est
construit à partir d'un ensemble d'autres éléments, mais qui peut être référencé comme un seul élément
graphique. Des mécanismes sont fournis pour ajouter des attributs aux éléments internes, qui
étaient spécifiés dans l'élément externe.
</p>

<p>
L'exemple ci-dessous montre comment une barre de défilement pourrait être déclarée (il a été un peu
simplifié par rapport à la réalité)&nbsp;:
</p>

<pre><code>
&lt;bindings xmlns="http://www.mozilla.org/xbl"
          xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"&gt;
  &lt;binding id="scrollbarBinding"&gt;
    &lt;content&gt;
      &lt;xul:scrollbarbutton type="decrement"/&gt;

      &lt;xul:slider flex="1"&gt;
        &lt;xul:thumb/&gt;
      &lt;xul:/slider&gt;
      &lt;xul:scrollbarbutton type="increment"/&gt;
    &lt;/content&gt;
  &lt;/binding&gt;

&lt;/bindings&gt;
</code></pre>

<p>
Ce fichier contient une seule liaison, déclarée avec l'élément <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/binding">binding</a></code>. L'attribut <code
class="attribut">id</code> devrait être déclaré avec l'identifiant de la liaison. De cette façon il
peut y être fait référence au travers de la propriété CSS <code> -moz-binding</code>.
</p>

<p>
La balise <code class="tag"><a  href="http://xulfr.org/wiki/Reference/Xbl/content">content</a></code> est
utilisée pour déclarer le contenu anonyme qui sera ajouté à la barre de défilement. Tous les éléments à
l'intérieur de la balise <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/content">content</a></code> seront ajoutés au sein de l'élément
auquel la liaison est liée. Cette liaison serait vraisemblablement liée à une barre de défilement,
bien qu'elle le ne doive pas. Chaque élément dont la propriété CSS <code>-moz-binding</code>
est déclarée avec l'URL de la liaison, va l'utiliser.
</p>

<p>
Utiliser la liaison ci-dessus a pour résultat la ligne de XUL ci-dessous interprétée comme
suit, en supposant que la barre de défilement est liée au XBL ci-dessus.
</p>

<pre><code>
&lt;scrollbar&gt;

<b>devient :</b>

&lt;scrollbar&gt;
  &lt;xul:scrollbarbutton type="decrement"/&gt;
    &lt;xul:slider flex="1"/&gt;
      &lt;xul:thumb/&gt;

    &lt;/xul:slider&gt;
  &lt;xul:scrollbarbutton type="increment"/&gt;
&lt;/scrollbar&gt;
</code></pre>

<p>
Les éléments au sein de la balise <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/content">content</a></code> sont ajoutés anonymement à
la barre de défilement. Bien que le contenu anonyme est montré à l'écran, vous ne pouvez pas y
accéder à l'aide d'un script par la voie normale. Dans XUL, c'est comme s'il n'y avait qu'un seul
élément, bien qu'il se compose réellement d'un certain nombre d'éléments.
</p>

<p>
Si vous observez une barre de défilement dans une fenêtre Mozilla, vous verrez qu'elle est
composée d'un bouton en forme de flèche, d'une zone de coulissement, d'une poignée à l'intérieur et
d'un second bouton en forme de flèche à la fin, ce sont les éléments qui apparaissent dans le contenu XBL
ci-dessus. Ces éléments pourraient à leur tour être liés à d'autres liaisons qui utilisent les
éléments XUL de base. Notez que les éléments de contenu ont besoin de l'espace de nommage de XUL
(ils apparaissent précédés de <var>xul:</var>), parce que ce sont des éléments de XUL et ne sont pas valides
dans XBL. Cet espace de nommage a été déclaré dans la balise <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/bindings">bindings</a></code>. Si vous n'utilisez pas l'espace de
nommage sur les éléments de XUL, Mozilla supposera que ce sont des éléments XBL, ne les comprendra
pas, et vos éléments ne fonctionneront pas correctement.
</p>

<p>
Un autre exemple, cette fois pour un champ dans lequel vous pourriez entrer un nom de fichier&nbsp;:
</p>

<pre><code>
&lt;binding id="fileentry"&gt;
  &lt;content&gt;

    &lt;textbox/&gt;
    &lt;button label="Parcourir..."/&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>

<p>
Attacher cette liaison à un élément fera qu'il contiendra un champ de texte, suivi d'un bouton
"Parcourir". Ce contenu interne est créé anonymement et ne peut être vu en utilisant le
<acronym title="Modèle Objet de Document">DOM</acronym>.
</p>

<p>
Le contenu anonyme est créé automatiquement chaque fois qu'une liaison est attachée à un élément.
Si vous placez des éléments fils à l'intérieur de XUL, ils vont écraser les éléments fournis par la
liaison. Par exemple, prenez ce morceau de XUL, en supposant qu'il est lié à la barre de
défilement XBL de tout à l'heure :
</p>

<pre><code>
&lt;scrollbar/&gt;

&lt;scrollbar&gt;
  &lt;button label="Overridden"/&gt;
&lt;/scrollbar&gt;
</code></pre>

<p>
Puisque la première barre de défilement n'a pas de contenu qui lui est propre, celui-ci
sera généré à partir de la définition de la liaison du fichier XBL. La seconde barre de défilement a
son propre contenu donc elle l'utilisera à la place du contenu XBL, ce qui a pour résultat quelque
chose qui ne ressemble plus à une barre de défilement. Notez que beaucoup d'éléments de construction
comme les barres de défilement, ont leur définition XBL stockées dans des fichiers situés dans le
répertoire "binding" du paquet toolkit.jar.
</p>

<p>
Ce mécanisme s'applique seulement aux éléments définis à l'intérieur de la balise <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/content">content</a></code>. Les propriétés, les méthodes et
d'autres aspects d'XBL sont encore disponibles, que le contenu provienne d'XBL ou que XUL fournisse son
propre contenu.
</p>

<p>
Il peut y avoir des fois où vous souhaitez que soient montrés à la fois le contenu XBL et celui
fournit par le fichier XUL. Vous pouvez faire cela en utilisant l'élément <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>. Les éléments fils dans XUL sont
ajoutés en lieu et place de l'élément <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>. C'est pratique pour créer des
éléments graphiques de menu personnalisés. Par exemple, une version simplifiée d'un élément
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/menulist">menulist</a></code> éditable,
pourrait être créée comme suit&nbsp;:
</p>

<pre><code>
<b>XUL:</b>

&lt;menu class="dropbox"&gt;
  &lt;menupopup&gt;
    &lt;menuitem label="1000"/&gt;

    &lt;menuitem label="2000"/&gt;
  &lt;/menupopup&gt;
&lt;/menu&gt;

<b>CSS:</b>

menu.dropbox {
    -moz-binding: url('chrome://example/skin/example.xml#dropbox');
}

<b>XBL:</b>

&lt;binding id="dropbox"&gt;

  &lt;content&gt;
    &lt;children/&gt;
    &lt;xul:textbox flex="1"/&gt;
    &lt;xul:button src="chrome://global/skin/images/dropbox.jpg"/&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>

<p>
Cet exemple crée un champ de saisie suivi d'un bouton. Le <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xul/menupopup">menupopup</a></code> sera ajouté au contenu
à l'emplacement spécifié par l'élément <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>. Notez que pour les fonctions du
<acronym title="Modèle Objet de Document">DOM</acronym>, le contenu apparaîtra comme s'il était dans
le fichier XUL, ainsi le menupopup sera un fils du menu. Le contenu XBL est caché ainsi le développeur
XUL n'a même pas besoin de savoir qu'il est là.
</p>

<p>
Le contenu qui en résulte serait :
</p>

<pre><code>
&lt;menu class="dropbox"&gt;
  &lt;menupopup&gt;
    &lt;menuitem label="1000"/&gt;
    &lt;menuitem label="2000"/&gt;
  &lt;/menupopup&gt;
  &lt;textbox flex="1"/&gt;

  &lt;button src="chrome://global/skin/images/dropbox.jpg"/&gt;
&lt;/menu&gt;
</code></pre>

<p>
Dans certains cas, vous pouvez souhaiter n'inclure que des types de contenus spécifiques et non
les autres. Ou bien, vous pouvez souhaiter placer différents types de contenus en différents
endroits. L'attribut <code class="attribut">includes</code> peut être utilisé pour n'autoriser que
certains éléments à apparaître dans le contenu. Sa valeur pourrait être déclarée à un simple nom de
balise, ou à une liste de balises séparées par des barres verticales (Le symbole |).
</p>

<pre><code>&lt;children includes="button"&gt;</code></pre>

<p>
Cette ligne va ajouter tous les boutons qui sont fils de l'élément lié en lieu et place de la
balise <code class="tag"><a  href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>.
 D'autres éléments ne correspondront pas à cette balise. Vous pouvez placer plusieurs éléments
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>
dans une liaison pour placer différents types de contenus à différents endroits. Si un élément
dans XUL ne correspond pas aux éléments <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>, cet élément (et chaque autre n'y
correspondant pas) sera utilisé à la place du contenu lié.
</p>

<p>
Voici un autre exemple. Disons que nous voulions créer un élément graphique qui affiche une image
avec un bouton de zoom "agrandir" et un bouton de zoom "diminuer" de part et d'autre. Ceci
pourrait être créé avec une boîte qui contiendrait l'image et deux boutons. L'élément image doit
être placé à l'extérieur du fichier XBL car il différera à chaque utilisation.
</p>

<pre><code>
<b>XUL:</b>

&lt;box class="zoombox"&gt;
  &lt;image src="images/happy.jpg"/&gt;
  &lt;image src="images/angry.jpg"/&gt;
&lt;/box&gt;

<b>XBL:</b>

&lt;binding id="zoombox"&gt;
  &lt;content&gt;
    &lt;xul:box flex="1"&gt;
      &lt;xul:button label="Zoom In"/&gt;
      &lt;xul:box flex="1" style="border: 1px solid black"&gt;

        &lt;children includes="image"/&gt;
      &lt;/xul:box&gt;
      &lt;xul:button label="Zoom Out"/&gt;
    &lt;/xul:box&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>

<p>
Les fils explicites dans le fichier XUL seront placés à l'endroit où se trouve la balise
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>.
Il y a deux images, ainsi toutes les deux seront ajoutées à côté de l'une et l'autre. Cela a
pour conséquence un affichage équivalent au suivant&nbsp;:
</p>

<pre><code>
&lt;binding id="zoombox"&gt;
  &lt;content&gt;
    &lt;xul:box flex="1"&gt;

      &lt;xul:button label="Zoom in"/&gt;
      &lt;xul:box flex="1" style="border: 1px solid black"&gt;
        &lt;image src="images/happy.jpg"/&gt;
        &lt;image src="images/angry.jpg"/&gt;
      &lt;/xul:box&gt;
      &lt;xul:button label="Zoom Out"/&gt;

    &lt;/xul:box&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>

<p>D'un point de vue du <acronym title="Modèle Objet de Document">DOM</acronym>,
les éléments fils sont toujours à leur emplacement
original. Ceci, parce que la boîte XUL externe a deux fils, qui sont les deux images. La boîte
interne avec la bordure a un fils, la balise <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>. C'est une distinction importante
lorsqu'on utilise le <acronym title="Modèle Objet de Document">DOM</acronym> avec XBL.
Cela s'applique également aux règles du sélecteur CSS.
</p>

<h2>Les éléments fils multiples</h2>

<p>
Vous pouvez également utiliser plusieurs éléments <code class="tag"><a
href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code> et avoir certains éléments placés
à un endroit et d'autres éléments placés à un autre. En ajoutant l'attribut <code
class="attribut">includes</code>  contenant une liste de nom de balises séparés par des barres
verticales, cela vous permet de placer uniquement les éléments correspondants à cet endroit. Par
exemple, le fichier XBL suivant va faire apparaître des étiquettes et des boutons de texte à un
endroit différent des autres éléments&nbsp;:
</p>

<p>Exemple 11.2.1&nbsp;: <a href="exemples/ex_xblcontent_1.xml.txt">Source</a></p>

<pre><code>
&lt;binding id="navbox"&gt;
  &lt;content&gt;
    &lt;xul:vbox&gt;
      &lt;xul:label value="Libellés et boutons"/&gt;
      &lt;children includes="label|button"/&gt;
    &lt;/xul:vbox&gt;

    &lt;xul:vbox&gt;
      &lt;xul:label value="Autres éléments"/&gt;
      &lt;children/&gt;
    &lt;/xul:vbox&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>

<p>
Le premier élément <code class="tag"><a  href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>
n'inclus que les éléments <code class="tag">label</code> et <code class="tag">bouton</code>,
comme indiqué dans son attribut <code class="attribut">includes</code>. Le second élément
<code class="tag"><a href="http://xulfr.org/wiki/Reference/Xbl/children">children</a></code>,
parce qu'il n'a pas d'attribut <code class="attribut">includes</code>, ajoute tous les éléments restants.
</p>

<hr />

<p>
Dans la prochaine section, nous verrons comment des attributs peuvent être hérités dans le
contenu anonyme.
</p>


