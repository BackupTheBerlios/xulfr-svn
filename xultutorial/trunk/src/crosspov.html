

 <p>Cette section décrit comment appliquer des overlays à des fichiers qui
      ne les importent pas. </p>

    <h2>Application d'overlays à d'autres paquetages</h2>

    <p> Les overlays ont d'autres fonctionnalités très utiles. Dans les exemples
      de la section précédente, les overlays étaient importés par la fenêtre.
      Vous pouvez aussi utiliser une autre méthode en précisant aux overlays pour
      quelles fenêtres ils seront appliqués. Il vous suffit de modifier le fichier
      contents.rdf de votre paquetage. Cette méthode est très utile car elle permet
      à un overlay de modifier l'interface utilisateur d'un autre paquetage sans
      pour cela modifier celui-ci. Par exemple, vous pouvez ajouter des items de menu
      ou des barres d'outils à la fenêtre du navigateur Mozilla. </p>

    <p>Nous utiliserons cette fonctionnalité pour ajouter une barre d'outils dans
      le fenêtre du navigateur Mozilla. Le client courrier de Mozilla utilise
      les overlays pour ajouter du contenu à la fenêtre du navigateur. Par exemple,
      si le client n'est pas installé, il n'y a pas de commande pour de nouveaux
      messages. Toutefois, si le client est installé, un overlay sera appliqué
      au menu pour ajouter une commande de nouveaux messages. Ci dessous, nous
      ajouterons une barre d'outils de recherche de fichiers au navigateur. Cette
      fonctionnalité n'a aucune utilité, mais nous l'intègreront quand même. </p>

    <p>Mozilla vous permet d'ajouter une liste d'overlays dans le fichier contents.rdf
      utilisé pour spécifier les paquetages chrome, les thèmes graphiques et les localisations.
      Dès que vous avez créé un overlay, vous pouvez l'ajouter au fichier contents.rdf.
      Il vous suffit d'ajouter les informations pour chacune des fenêtres où vous
      voulez appliquer l'overlay. </p>


 <div class="task">
    <p>Tout d'abord, créons un simple overlay. Il contiendra quelques champs de
      saisie pour le recherche d'un nom de fichier et d'un répertoire. Nommez
      le fichier <var>foverlay.xul</var> et ajoutez le au répertoire de notre
      exemple de recherche de fichier à côté de <var>findfile.xul</var>.</p>

    <p>Exemple 12.7.1 : <a href="exemples/ex_crosspov_1.xul.txt">Source</a>
   <a href="exemples/ex_crosspov_1bis.xul" onclick="window.open(this.href,'xulex','chrome,resizable'); return false;">Voir
      (avec la balise window)</a></p>

    <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; ?&gt;

&lt;overlay
     xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;

&lt;toolbox id=&quot;navigator-toolbox&quot;&gt;
  &lt;toolbar id=&quot;findfile_toolbar&quot;&gt;
    &lt;label control=&quot;findfile_filename&quot; value=&quot;Recherche des fichiers nomm&eacute;s:&quot;/&gt;
    &lt;textbox id=&quot;findfile_filename&quot;/&gt;
    &lt;label control=&quot;findfile_dir&quot; value=&quot;R&eacute;pertoire:&quot;/&gt;
    &lt;textbox id=&quot;findfile_dir&quot;/&gt;
    &lt;button label=&quot;Parcourir...&quot;/&gt;
  &lt;/toolbar&gt;
&lt;/toolbox&gt;

&lt;/overlay&gt;</code></pre>

    <p>Vous pouvez visualiser cet exemple en changeant l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/overlay">overlay</a></code>
      par <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/window">window</a></code>.
      La seule chose un peu spécifique est l'attribut <code class="attribut">id</code>
      utilisé sur l'élément <code class="tag"><a href="http://xulfr.org/wiki/Reference/Xul/toolbox">toolbox</a></code>.
      Cette valeur (<var>navigator-toolbox</var>) est la même que l'identifiant
      de la boîte d'outils de la fenêtre du navigateur (<var>navigator.xul</var>).
      Cela signifie que cet overlay sera appliqué à la boîte d'outils du navigateur
      et que son contenu sera ajouté comme une barre d'outils supplémentaire.</p>

    <p>Pour ajouter cet overlay au fichier manifest, vous devons ajouter deux
      ressources. Premièrement, nous en ajoutons une pour chaque fenêtre où l'overlay
      sera appliqué. Le code suivant doit être placé dans le fichier contents.rdf
      juste avant la balise fermante de RDF. </p>

    <pre><code>&lt;RDF:Seq RDF:about=&quot;urn:mozilla:overlays&quot;&gt;
  &lt;RDF:li RDF:resource=&quot;chrome://navigator/content/navigator.xul&quot;/&gt;
&lt;/RDF:Seq&gt;</code></pre>

    <p>Cette déclaration précise l'ajout d'une fenêtre overlay au système de gestion
      des overlays (urn:mozilla:overlays). Vous pouvez ajouter des noeuds supplémentaires
      pour chaque fenêtre à modifier en ajoutant des balises <code class="tag">li</code>
      supplémentaires.</p>

    <p>Ensuite, nous ajoutons un noeud pour chaque overlay s'appliquant à la fenêtre.
      Dans ce cas, vous n'en avez qu'un, mais d'autres peuvent être appliqués.
      Ajoutez ces lignes à la suite des précédentes&nbsp;:</p>

    <pre><code>&lt;RDF:Seq RDF:about=&quot;chrome://navigator/content/navigator.xul&quot;&gt;
  &lt;RDF:li&gt;chrome://findfile/content/foverlay.xul&lt;/RDF:li&gt;
&lt;/RDF:Seq&gt;</code></pre>

    </div>


    <p>Mozilla lit cette information et construit une liste d'overlays appliqués
      à d'autres fenêtres. Il enregistre cette information dans un répertoire
      chrome/overlayinfo. Il n'est pas nécessaire que vous modifiez manuellement
      les fichiers de ce répertoire. Ils sont générés automatiquement et modifiés
      au premier lancement de Mozilla ou lorque de nouveaux paquetages sont installés.
      Toutefois, vous pouvez forcer la reconstruction de leurs données en effaçant
      ce répertoire et le fichier chrome.rdf.</p>

    <p><img src="images/crosspov.png" alt="" class="screenshot" /></p>

   <div class="note">
    <p>Note complémentaire : vous pouvez utiliser cette même technique pour appliquer
      des feuilles de styles supplémentaires. L'exemple suivant vous montre comment&nbsp;:</p>

    <pre><code>&lt;RDF:Seq RDF:about=&quot;urn:mozilla:stylesheets&quot;&gt;
  &lt;RDF:li RDF:resource=&quot;chrome://messenger/content/messenger.xul&quot;/&gt;
&lt;/RDF:Seq&gt;

&lt;RDF:Seq RDF:about=&quot;chrome://messenger/content/messenger.xul&quot;&gt;
  &lt;RDF:li&gt;chrome://blueswayedshoes/skin/myskinfile.css&lt;/RDF:li&gt;
&lt;/RDF:Seq&gt;</code></pre>
</div>
    <hr/>
    <p>Nous verrons ensuite comment créer un installeur pour une application XUL.</p>

